# Bank Card Management System

## Описание проекта

Backend-часть системы управления банковскими картами, разработанная на Java с использованием Spring Boot. Система
предоставляет REST API для создания, управления и просмотра данных о банковских картах, а также выполнения операций
между картами пользователя.

Для безопастности применены: аутентификация и авторизация через JWT, шифрование и маскирование номеров карт, поддержка ролей (администратор и пользователь).

## Функциональные возможности

### Для администраторов:

* Создание, изменение, блокировка и удаление карт
* Просмотр всех карт в системе
* Управление пользователями

### Для пользователей:

* Просмотр своих карт с возможностью постраничной выдачи
* Запрос на блокировку карты
* Переводы между своими картами
* Просмотр баланса по картам

## Технологический стек

* **Java 17+**
* **Spring Boot**
* **Spring Security** (для аутентификации и авторизации)
* **JWT аутентификация**
* **Spring Data JPA** (Hibernate для работы с базой данных)
* **PostgreSQL** (выбор базы данных зависит от настроек)
* **Liquibase** (миграции БД)
* **Docker** (для контейнеризации приложения)
* **OpenAPI (Swagger UI)** (для документации API)

## Требования к окружению

* **JDK 17+**
* **Maven 3.6+**
* **Docker 20.10+**
* **Docker Compose 1.29+**

## Установка и запуск

### 1. Клонирование репозитория

```bash
git clone https://github.com/Andrey-rock/bank-card-management-system.git
cd Bankcard-managment
```

### 2. Настройка окружения

Для корректной работы приложения необходимо настроить несколько компонентов:

1. **База данных**: В файле `src/main/resources/application.yml` указываются настройки подключения к базе данных
   PostgreSQL или MySQL.
   Пример настроек для PostgreSQL:

   ```yaml
   spring:
     datasource:
    url: jdbc:postgresql://localhost:5432/bank
    username: user
    password: 1234
   ```

2. **Liquibase**: Миграции базы данных настроены через Liquibase. Убедитесь, что файл миграции актуален. При первом
   запуске миграции будут автоматически применяться.

### 3. Запуск через Docker Compose

Для запуска приложения с использованием Docker Compose, выполните следующие команды:

```bash
docker-compose up -d
```

Приложение будет доступно по адресу: `http://localhost:8081`

Docker Compose поднимет все необходимые сервисы, включая PostgreSQL и приложение, с настройками, указанными в
`docker-compose.yml`.

### 4. Альтернативный запуск (без Docker)

1. Убедитесь, что у вас установлена и запущена PostgreSQL или MySQL.

2. Настройте параметры подключения к базе данных в файле `src/main/resources/application.yml`.

3. Выполните команду для запуска приложения:

```bash
mvn spring-boot:run
```

Приложение будет доступно по адресу: `http://localhost:8081`.

## Миграции базы данных

Миграции выполняются автоматически при старте приложения через **Liquibase**. Все файлы миграций находятся в директории
`src/main/resources/db/migration/changelog-master.yml`.

При первом запуске приложение автоматически применит все миграции и создаст необходимые таблицы в базе данных.

## API документация

После запуска приложения документация API будет доступна через **Swagger UI**:

* Swagger UI: `http://localhost:8081/swagger-ui.html`
* OpenAPI спецификация: `http://localhost:8081/v3/api-docs`

## Тестирование

Для запуска тестов в проекте, выполните следующую команду:

```bash
mvn test
```
